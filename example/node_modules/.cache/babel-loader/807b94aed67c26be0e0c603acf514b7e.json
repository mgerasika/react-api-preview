{"ast":null,"code":"import { IS_DEBUG } from '../../constants/is-debug.constant.js';\nimport { InlineJsonPreview } from '../json-preview/json-preview.component.js';\nimport React, { useCallback, useMemo } from 'react';\nimport { FormProvider } from 'react-hook-form';\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n// For some components need trigger validate event manually, so added additional context.\n\nvar FormAdditionalContext = /*#__PURE__*/React.createContext({\n  registerBlurHandler: function registerBlurHandler() {\n    return null;\n  },\n  onFieldBlur: function onFieldBlur() {\n    return null;\n  },\n  onFieldChange: function onFieldChange() {\n    return null;\n  }\n});\nfunction Form(_ref) {\n  var children = _ref.children,\n    _ref$form = _ref.form,\n    formContext = _ref$form.formContext,\n    isValid = _ref$form.isValid,\n    _ref$form$props = _ref$form.props,\n    onFieldBlur = _ref$form$props.onFieldBlur,\n    onFieldChange = _ref$form$props.onFieldChange,\n    onSubmit = _ref$form$props.onSubmit,\n    _onBlurHandlers = _ref$form._onBlurHandlers,\n    className = _ref.className;\n  var handleSubmit = useCallback(function (data) {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    onSubmit(data);\n  }, [onSubmit]);\n  var renderJsonPreview = function renderJsonPreview() {\n    var json = {\n      values: formContext.getValues(),\n      errors: formContext.formState.errors,\n      touched: formContext.formState.touchedFields,\n      formState: formContext.formState,\n      isValid: isValid\n    };\n    return /*#__PURE__*/React.createElement(InlineJsonPreview, {\n      json: json,\n      collapsed_json: false\n    });\n  };\n  var registerBlurHandler = useCallback(function (fieldName, handler) {\n    _onBlurHandlers[fieldName] = handler;\n  }, [_onBlurHandlers]);\n  var onFieldBlurHandler = useCallback(function (fieldName) {\n    onFieldBlur && onFieldBlur(fieldName, formContext.getValues());\n  }, [onFieldBlur, formContext]);\n  var onFieldChangeHandler = useCallback(function (fieldName) {\n    onFieldChange && onFieldChange(fieldName, formContext.getValues());\n  }, [formContext, onFieldChange]);\n  var additionalContext = useMemo(function () {\n    return {\n      registerBlurHandler: registerBlurHandler,\n      onFieldBlur: onFieldBlurHandler,\n      onFieldChange: onFieldChangeHandler\n    };\n  }, [onFieldBlurHandler, onFieldChangeHandler, registerBlurHandler]);\n  return /*#__PURE__*/React.createElement(FormProvider, formContext, /*#__PURE__*/React.createElement(FormAdditionalContext.Provider, {\n    value: additionalContext\n  }, IS_DEBUG && renderJsonPreview(), /*#__PURE__*/React.createElement(\"form\", {\n    autoComplete: \"off\",\n    className: className,\n    onSubmit: formContext.handleSubmit(handleSubmit)\n  }, children)));\n}\nexport { Form, FormAdditionalContext };","map":{"version":3,"sources":["../../../../src/general-ui/form/form.component.tsx"],"names":["FormAdditionalContext","React","createContext","registerBlurHandler","onFieldBlur","onFieldChange","Form","children","form","formContext","isValid","props","onSubmit","_onBlurHandlers","className","handleSubmit","useCallback","data","renderJsonPreview","json","values","getValues","errors","formState","touched","touchedFields","InlineJsonPreview","collapsed_json","fieldName","handler","onFieldBlurHandler","onFieldChangeHandler","additionalContext","useMemo","FormProvider","Provider","value","IS_DEBUG","autoComplete"],"mappings":"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","sourcesContent":["/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { IS_DEBUG } from '@common/constants/is-debug.constant';\nimport { InlineJsonPreview } from '@common/general-ui/json-preview/json-preview.component';\nimport { IUseCustomFormReturn } from '@common/hooks/use-form.hook';\nimport React, { ChangeEventHandler, ReactNode, useCallback, useMemo } from 'react';\nimport { FormProvider, UnpackNestedValue } from 'react-hook-form';\n\n// For some components need trigger validate event manually, so added additional context.\nexport interface IFormAdditionalContextProps<T> {\n    registerBlurHandler: (name: keyof T, handler: ChangeEventHandler) => void;\n    onFieldBlur: (name: keyof T) => void;\n    onFieldChange: (name: keyof T) => void;\n}\n\nexport const FormAdditionalContext = React.createContext<IFormAdditionalContextProps<unknown>>({\n    registerBlurHandler: () => null,\n    onFieldBlur: () => null,\n    onFieldChange: () => null,\n});\n\ninterface IProps<T> {\n    form: IUseCustomFormReturn<T>;\n    children: ReactNode;\n    className?: string;\n}\n\nexport function Form<T>({\n    children,\n    form: {\n        formContext,\n        isValid,\n        props: { onFieldBlur, onFieldChange, onSubmit },\n        _onBlurHandlers,\n    },\n    className,\n}: IProps<T>): JSX.Element {\n    const handleSubmit = useCallback(\n        (data: UnpackNestedValue<T>) => {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            onSubmit(data as any);\n        },\n        [onSubmit],\n    );\n\n    const renderJsonPreview = (): JSX.Element => {\n        const json = {\n            values: formContext.getValues(),\n            errors: formContext.formState.errors,\n            touched: formContext.formState.touchedFields,\n            formState: formContext.formState,\n            isValid,\n        };\n        return <InlineJsonPreview json={json} collapsed_json={false} />;\n    };\n\n    const registerBlurHandler = useCallback(\n        (fieldName: keyof T, handler: ChangeEventHandler) => {\n            _onBlurHandlers[fieldName as string] = handler;\n        },\n        [_onBlurHandlers],\n    );\n\n    const onFieldBlurHandler = useCallback(\n        (fieldName: keyof T) => {\n            onFieldBlur && onFieldBlur(fieldName, formContext.getValues() as T);\n        },\n        [onFieldBlur, formContext],\n    );\n\n    const onFieldChangeHandler = useCallback(\n        (fieldName: keyof T) => {\n            onFieldChange && onFieldChange(fieldName, formContext.getValues() as T);\n        },\n        [formContext, onFieldChange],\n    );\n\n    const additionalContext: IFormAdditionalContextProps<T> = useMemo(() => {\n        return {\n            registerBlurHandler,\n            onFieldBlur: onFieldBlurHandler,\n            onFieldChange: onFieldChangeHandler,\n        };\n    }, [onFieldBlurHandler, onFieldChangeHandler, registerBlurHandler]);\n\n    return (\n        <FormProvider {...(formContext as any)}>\n            <FormAdditionalContext.Provider value={additionalContext}>\n                {IS_DEBUG && renderJsonPreview()}\n                <form autoComplete=\"off\" className={className} onSubmit={formContext.handleSubmit(handleSubmit as any)}>\n                    {children}\n                </form>\n            </FormAdditionalContext.Provider>\n        </FormProvider>\n    );\n}\n"]},"metadata":{},"sourceType":"module"}