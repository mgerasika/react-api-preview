{"ast":null,"code":"import { slicedToArray as _slicedToArray, toConsumableArray as _toConsumableArray } from '../_virtual/_rollupPluginBabelHelpers.js';\nimport { useState, useCallback } from 'react';\nimport { useTimeout } from './use-timeout.hook.js';\nvar useIndividualPromise = function useIndividualPromise(_ref) {\n  var _ref$parallel = _ref.parallel,\n    parallel = _ref$parallel === void 0 ? true : _ref$parallel;\n  var _useState = useState(false),\n    _useState2 = _slicedToArray(_useState, 2),\n    loading = _useState2[0],\n    setIsLoading = _useState2[1];\n  var _useState3 = useState([]),\n    _useState4 = _slicedToArray(_useState3, 2),\n    result = _useState4[0],\n    setResult = _useState4[1];\n  var _useTimeout = useTimeout(useCallback(function (promises) {\n      if (!parallel) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        promises.reduce(function (acc, item) {\n          return acc.finally(function () {\n            return item === null || item === void 0 ? void 0 : item.promiseFn().then(function () {\n              setResult(function (prevs) {\n                return prevs.map(function (prev) {\n                  if (prev.id === item.id) {\n                    return {\n                      id: item.id,\n                      loading: false,\n                      success: true,\n                      error: undefined\n                    };\n                  }\n                  return prev;\n                });\n              });\n            }).catch(function (e) {\n              setResult(function (prevs) {\n                return prevs.map(function (prev) {\n                  if (prev.id === item.id) {\n                    return {\n                      id: item.id,\n                      loading: false,\n                      success: false,\n                      error: e\n                    };\n                  }\n                  return prev;\n                });\n              });\n            }).finally(function () {\n              return setIsLoading(false);\n            });\n          });\n        }, Promise.resolve());\n      } else {\n        promises.forEach(function (item) {\n          item.promiseFn().then(function () {\n            setResult(function (prevs) {\n              return prevs.map(function (prev) {\n                if (prev.id === item.id) {\n                  return {\n                    id: item.id,\n                    loading: false,\n                    success: true,\n                    error: undefined\n                  };\n                }\n                return prev;\n              });\n            });\n          }).catch(function (e) {\n            setResult(function (prevs) {\n              return prevs.map(function (prev) {\n                if (prev.id === item.id) {\n                  return {\n                    id: item.id,\n                    loading: false,\n                    success: false,\n                    error: e\n                  };\n                }\n                return prev;\n              });\n            });\n          }).finally(function () {\n            return setIsLoading(false);\n          });\n        });\n      }\n    }, [parallel]), 50),\n    startTimeout = _useTimeout.start;\n  return {\n    start: useCallback(function (promises) {\n      setResult([]);\n      setIsLoading(true);\n      promises.forEach(function (item) {\n        setResult(function (prev) {\n          return [].concat(_toConsumableArray(prev), [{\n            id: item.id,\n            loading: true,\n            success: false,\n            error: undefined\n          }]);\n        });\n      });\n      startTimeout(promises);\n    }, [startTimeout]),\n    loading: result.some(function (r) {\n      return r.loading;\n    }) || loading,\n    clearResults: useCallback(function () {\n      setResult([]);\n    }, []),\n    result: result\n  };\n};\nexport { useIndividualPromise };","map":{"version":3,"sources":["../../../src/hooks/use-individual-promise.hook.ts"],"names":["useIndividualPromise","parallel","loading","setIsLoading","useState","_useState2","result","setResult","_useState4","start","startTimeout","useTimeout","useCallback","promises","reduce","acc","item","finally","promiseFn","then","prevs","map","prev","id","success","error","undefined","catch","e","Promise","resolve","forEach","some","r","clearResults"],"mappings":"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","sourcesContent":["import { IBEError } from '@common/interfaces/be-error.interface';\nimport { useCallback, useState } from 'react';\nimport { useTimeout } from './use-timeout.hook';\n\nexport interface IPromiseItem {\n    id: string;\n    promiseFn: () => Promise<unknown>;\n}\nexport interface IPromiseResult {\n    id: string;\n    loading: boolean;\n    success: boolean;\n    error: IBEError | undefined;\n}\ninterface IReturn {\n    start: (promises: IPromiseItem[]) => void;\n    loading: boolean;\n    result: IPromiseResult[];\n    clearResults: () => void;\n}\nexport const useIndividualPromise = ({ parallel = true }: { parallel?: boolean }): IReturn => {\n    const [loading, setIsLoading] = useState<boolean>(false);\n    const [result, setResult] = useState<IPromiseResult[]>([]);\n    const { start: startTimeout } = useTimeout<IPromiseItem[]>(\n        useCallback(\n            (promises: IPromiseItem[]): void => {\n                if (!parallel) {\n                    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                    promises.reduce((acc, item?: IPromiseItem): any => {\n                        return acc.finally(() => {\n                            return item\n                                ?.promiseFn()\n                                .then((): void => {\n                                    setResult((prevs): IPromiseResult[] => {\n                                        return prevs.map((prev) => {\n                                            if (prev.id === item.id) {\n                                                return { id: item.id, loading: false, success: true, error: undefined };\n                                            }\n                                            return prev;\n                                        });\n                                    });\n                                })\n                                .catch((e) => {\n                                    setResult((prevs): IPromiseResult[] => {\n                                        return prevs.map((prev) => {\n                                            if (prev.id === item.id) {\n                                                return { id: item.id, loading: false, success: false, error: e };\n                                            }\n                                            return prev;\n                                        });\n                                    });\n                                })\n                                .finally(() => setIsLoading(false));\n                        });\n                    }, Promise.resolve());\n                } else {\n                    promises.forEach((item) => {\n                        item.promiseFn()\n                            .then((): void => {\n                                setResult((prevs): IPromiseResult[] => {\n                                    return prevs.map((prev) => {\n                                        if (prev.id === item.id) {\n                                            return { id: item.id, loading: false, success: true, error: undefined };\n                                        }\n                                        return prev;\n                                    });\n                                });\n                            })\n                            .catch((e) => {\n                                setResult((prevs): IPromiseResult[] => {\n                                    return prevs.map((prev) => {\n                                        if (prev.id === item.id) {\n                                            return { id: item.id, loading: false, success: false, error: e };\n                                        }\n                                        return prev;\n                                    });\n                                });\n                            })\n                            .finally(() => setIsLoading(false));\n                    });\n                }\n            },\n            [parallel],\n        ),\n        50,\n    );\n\n    return {\n        start: useCallback(\n            (promises: IPromiseItem[]): void => {\n                setResult([]);\n                setIsLoading(true);\n\n                promises.forEach((item) => {\n                    setResult((prev): IPromiseResult[] => {\n                        return [...prev, { id: item.id, loading: true, success: false, error: undefined }];\n                    });\n                });\n\n                startTimeout(promises);\n            },\n            [startTimeout],\n        ),\n        loading: result.some((r) => r.loading) || loading,\n        clearResults: useCallback(() => {\n            setResult([]);\n        }, []),\n        result,\n    };\n};\n"]},"metadata":{},"sourceType":"module"}